<!DOCTYPE html>

<html>
    <head>
        <title>Tatsu WebGL Demo</title>
        <!-- TODO: Minify tatsu.js and associated scripts. -->
        <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
        <script src="../../lib/glMatrix-0.9.5.min.js"></script>
        <script src="../../src/Tatsu.js"></script>
        <script src="../../src/Graphics/Types.js"></script>
        <script src="../../src/Graphics/Renderer.js"></script>
        <script src="../../src/Graphics/Material.js"></script>
        <script src="../../src/Graphics/Model.js"></script>
        
        <script type="text/javascript">
            var tatsu, material, model,
                attributes = {
                    position: {
                        type: 'v3',
                        value: vec3.create()
                    }
                },
                uniforms = {
                    matModelView: {
                        type: 'm4',
                        value: mat4.identity(mat4.create())
                    },
                    matProj: {
                        type: 'm4',
                        value: mat4.identity(mat4.create())
                    }
                };

            function draw() {
                tatsu.clear();
            }

            function doFrame() {
                requestAnimationFrame(doFrame);
                draw();
            }

            function tatsuLoad() {
                var fragShader, vertShader;
                var foo = $.get('sandbox.fs', function(data) {
                    fragShader = data;
                });
                $.get('sandbox.vs', function(data) {
                    vertShader = data;
                });

                tatsu = new Tatsu.Renderer({
                    element: 'tatsu-canvas',
                    clearColor: [0.392156862745098, 0.5843137254901961, 0.9294117647058824, 1.0]
                });
                material = new Tatsu.Material(tatsu, {
                    fragmentUrl: 'sandbox.fs',
                    vertexUrl: 'sandbox.vs',
                    attributes: attributes,
                    uniforms: uniforms
                });
                modelTri = new Tatsu.Model(tatsu, {
                    streams: {
                        position: {
                            type: 'float',
                            stride: 3,
                            data: [
                                 0.0,  1.0,  0.0,
                                -1.0, -1.0,  0.0,
                                 1.0, -1.0,  0.0
                            ]
                        }
                    }
                    // faces: {
                    //     type: 'uint16',
                    //     data: []
                    // }
                });
                modelSquare = new Tatsu.Model(tatsu, {
                    streams: {
                        position: {
                            type: 'float',
                            stride: 3,
                            data: [
                                 1.0,  1.0,  0.0,
                                -1.0,  1.0,  0.0,
                                 1.0, -1.0,  0.0,
                                -1.0, -1.0,  0.0
                            ]
                        }
                    }
                });


                doFrame();
            }
        </script>
    </head>
    <body onload="tatsuLoad();">
        <canvas id="tatsu-canvas" style="border: none;" width="800" height="600"></canvas>
    </body>
</html>